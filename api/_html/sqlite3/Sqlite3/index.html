<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sqlite3 (sqlite3.Sqlite3)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">sqlite3</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Sqlite3</span></h1></header><p>API for Sqlite 3.* databases</p><h3>Exceptions</h3><div class="spec exception" id="exception-InternalError"><a href="#exception-InternalError" class="anchor"></a><div class="def exception"><code><span class="keyword">exception </span></code><code><span class="exception">InternalError</span><span class="keyword"> of </span>string</code></div><div class="doc"><p><code class="code">InternalError reason</code> is raised when the bindings detect an
unknown/unsupported situation.</p></div></div><div class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><div class="def exception"><code><span class="keyword">exception </span></code><code><span class="exception">Error</span><span class="keyword"> of </span>string</code></div><div class="doc"><p><code class="code">Error reason</code> is raised when some SQL operation is called on a
nonexistent handle and the functions does not return a return code,
or if there is no error code corresponding to this error.
Functions returning return codes communicate errors by returning
the specific error code.</p></div></div><div class="spec exception" id="exception-RangeError"><a href="#exception-RangeError" class="anchor"></a><div class="def exception"><code><span class="keyword">exception </span></code><code><span class="exception">RangeError</span><span class="keyword"> of </span>int<span class="keyword"> * </span>int</code></div><div class="doc"><p><code class="code">RangeError (index, maximum)</code> is raised if some column or bind
operation refers to a nonexistent column or binding. The first
entry of the returned tuple is the specified index, the second is
the limit which was violated.</p></div></div><h3>Types</h3><div class="spec type" id="type-db"><a href="#type-db" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>db</code><code></code><code></code></div><div class="doc"><p>Database handle. Used to store information regarding open
databases and the error code from the last operation if the function
implementing that operation takes a database handle as a parameter.</p><ul class="at-tag"><li><p><span class="at-tag see">See</span> <a href="https://sqlite.org/threadsafe.html">https://sqlite.org/threadsafe.html</a>about thread safety when
accessing database handles and also consider using the <code class="code">mutex</code> flag with
<a href="index.html#val-db_open">db_open</a> if necessary.</p><p>NOTE: database handles are closed (see <a href="index.html#val-db_close">db_close</a>) automatically
when they are reclaimed by the GC unless they have already been
closed earlier by the user. It is good practice to manually close
database handles to free resources as quickly as possible.</p></li></ul></div></div><div class="spec type" id="type-stmt"><a href="#type-stmt" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>stmt</code><code></code><code></code></div><div class="doc"><p>Compiled statement handle. Stores information about compiled
statements created by the <code class="code">prepare</code> or <code class="code">prepare_tail</code> functions.</p><ul class="at-tag"><li><span class="at-tag see">See</span> <a href="https://sqlite.org/threadsafe.html">https://sqlite.org/threadsafe.html</a>about thread safety when
accessing statement handles.</li></ul></div></div><div class="spec type" id="type-header"><a href="#type-header" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>header</code><code><span class="keyword"> = </span>string</code><code></code></div><div class="doc"><p>Type of name of a column returned by queries.</p></div></div><div class="spec type" id="type-headers"><a href="#type-headers" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>headers</code><code><span class="keyword"> = </span><a href="index.html#type-header">header</a> array</code><code></code></div><div class="doc"><p>Type of names of columns returned by queries.</p></div></div><div class="spec type" id="type-row"><a href="#type-row" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>row</code><code><span class="keyword"> = </span>string option array</code><code></code></div><div class="doc"><p>Type of row data (with potential NULL-values)</p></div></div><div class="spec type" id="type-row_not_null"><a href="#type-row_not_null" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>row_not_null</code><code><span class="keyword"> = </span>string array</code><code></code></div><div class="doc"><p>Type of row data (without NULL-values)</p></div></div><h3>Return codes</h3><div class="spec module" id="module-Rc"><a href="#module-Rc" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Rc/index.html">Rc</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h3>Column data types</h3><div class="spec module" id="module-Data"><a href="#module-Data" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Data/index.html">Data</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h3>General database operations</h3><div class="spec val" id="val-db_open"><a href="#val-db_open" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>db_open : ?&#8288;mode:[ `READONLY | `NO_CREATE ] <span class="keyword">&#8209;&gt;</span> ?&#8288;uri:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;memory:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;mutex:[ `NO | `FULL ] <span class="keyword">&#8209;&gt;</span> ?&#8288;cache:[ `SHARED | `PRIVATE ] <span class="keyword">&#8209;&gt;</span> ?&#8288;vfs:string <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-db">db</a></code></div><div class="doc"><p><code class="code">db_open ?mode ?uri ?memory ?mutex ?cache ?vfs filename</code> opens the
database file <code class="code">filename</code>, and returns a database handle.</p><p>Special filenames: &quot;:memory:&quot; and &quot;&quot; open an in-memory or temporary
database respectively.
Behaviour explained here: https://www.sqlite.org/inmemorydb.html</p><p>The optional arguments <code class="code">mode</code>, <code class="code">uri</code>, <code class="code">memory</code> and <code class="code">mutex</code> are only
meaningful with SQLite versions &gt;= 3.5, <code class="code">cache</code> only for versions &gt;= 3.6.18.
For older versions an exception will be raised if any of them is set to a
non-default value. The database is opened read-only if <code class="code">`READONLY</code> is
passed as mode. The database file will not be created if it is missing and
<code class="code">`NO_CREATE</code> is set. The <code class="code">uri</code> parameter enables URI filename
interpretation and corresponds to <code class="code">SQLITE_OPEN_URI</code> in the SQLite3 API.
The <code class="code">memory</code> parameter opens an in-memory database and corresponds to
<code class="code">SQLITE_OPEN_MEMORY</code> in the SQLite3 API. <code class="code">mutex</code> determines how the
database is accessed. The mutex parameters <code class="code">`NO</code> and <code class="code">`FULL</code> correspond to
<code class="code">SQLITE_OPEN_NOMUTEX</code> and <code class="code">SQLITE_OPEN_FULLMUTEX</code> in the SQLite3 API
respectively. The cache parameters <code class="code">`SHARED</code> and <code class="code">`PRIVATE</code> correspond to
<code class="code">SQLITE_OPEN_SHAREDCACHE</code> and <code class="code">SQLITE_OPEN_PRIVATECACHE</code> in the SQLite3 API
respectively.</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">mode</span>: default = read-write, create</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">uri</span>: default = false</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">memory</span>: default = false</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">mutex</span>: default = nothing</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">cache</span>: default = nothing</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">vfs</span>: default = nothing</li></ul></div></div><div class="spec val" id="val-db_close"><a href="#val-db_close" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>db_close : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">db_close db</code> closes database <code class="code">db</code> and invalidates the handle.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> <code class="code">false</code> if database was busy (database not closed in this
case!), <code class="code">true</code> otherwise.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-enable_load_extension"><a href="#val-enable_load_extension" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>enable_load_extension : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> bool <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p><code class="code">enable_load_extension db onoff</code> enable/disable the sqlite3 load
extension.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> <code class="code">false</code> if the operation fails, <code class="code">true</code>
otherwise.</li></ul></div></div><div class="spec val" id="val-errcode"><a href="#val-errcode" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>errcode : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">errcode db</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the error code of the last operation on database
<code class="code">db</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-errmsg"><a href="#val-errmsg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>errmsg : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p><code class="code">errmsg db</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the error message of the last operation on
database <code class="code">db</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-last_insert_rowid"><a href="#val-last_insert_rowid" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>last_insert_rowid : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> int64</code></div><div class="doc"><p><code class="code">last_insert_rowid db</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the index of the row inserted by
the last operation on database <code class="code">db</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-exec"><a href="#val-exec" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>exec : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;cb:(<a href="index.html#type-row">row</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-headers">headers</a> <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">exec db ?cb sql</code> performs SQL-operation <code class="code">sql</code> on database <code class="code">db</code>.
If the operation contains query statements, then the callback function
<code class="code">cb</code> will be called for each matching row. The first parameter of
the callback is the contents of the row, the second paramater are the
headers of the columns associated with the row. Exceptions raised
within the callback will abort the execution and escape <a href="index.html#val-exec">exec</a>.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of the operation.</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">cb</span>: default = no callback</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-exec_no_headers"><a href="#val-exec_no_headers" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>exec_no_headers : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> cb:(<a href="index.html#type-row">row</a> <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">exec_no_headers db ?cb sql</code> performs SQL-operation <code class="code">sql</code> on database
<code class="code">db</code>. If the operation contains query statements, then the callback
function <code class="code">cb</code> will be called for each matching row. The parameter
of the callback is the contents of the row. Exceptions raised within
the callback will abort the execution and escape <a href="index.html#val-exec_no_headers">exec_no_headers</a>.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of the operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-exec_not_null"><a href="#val-exec_not_null" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>exec_not_null : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> cb:(<a href="index.html#type-row_not_null">row_not_null</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-headers">headers</a> <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">exec_not_null db ~cb sql</code> performs SQL-operation <code class="code">sql</code> on database
<code class="code">db</code>. If the operation contains query statements, then the callback
function <code class="code">cb</code> will be called for each matching row. The first
parameter of the callback is the contents of the row, which must
not contain NULL-values, the second paramater are the headers of
the columns associated with the row. Exceptions raised within the
callback will abort the execution and escape <a href="index.html#val-exec_not_null">exec_not_null</a>.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of the operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if a row contains NULL.</li></ul></div></div><div class="spec val" id="val-exec_not_null_no_headers"><a href="#val-exec_not_null_no_headers" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>exec_not_null_no_headers : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> cb:(<a href="index.html#type-row_not_null">row_not_null</a> <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">exec_not_null_no_headers db ~cb sql</code> performs SQL-operation <code class="code">sql</code>
on database <code class="code">db</code>. If the operation contains query statements, then
the callback function <code class="code">cb</code> will be called for each matching row.
The parameter of the callback is the contents of the row, which must
not contain NULL-values. Exceptions raised within the callback will
abort the execution and escape <a href="index.html#val-exec_not_null_no_headers">exec_not_null_no_headers</a>.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of the operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if a row contains NULL.</li></ul></div></div><div class="spec val" id="val-changes"><a href="#val-changes" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>changes : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">changes db</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the number of rows that were changed
or inserted or deleted by the most recently completed SQL statement
on database <code class="code">db</code>.</li></ul></div></div><h3>Fine grained query operations</h3><div class="spec val" id="val-prepare"><a href="#val-prepare" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>prepare : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-stmt">stmt</a></code></div><div class="doc"><p><code class="code">prepare db sql</code> compile SQL-statement <code class="code">sql</code> for database <code class="code">db</code>
into bytecode. The statement may be only partially compiled.
In this case <a href="index.html#val-prepare_tail">prepare_tail</a> can be called on the returned statement
to compile the remaining part of the SQL-statement.</p><p>NOTE: this really uses the C-function <code class="code">sqlite3_prepare_v2</code>,
i.e. avoids the older, deprecated <code class="code">sqlite3_prepare</code>-function.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement could not be prepared.</li></ul></div></div><div class="spec val" id="val-prepare_tail"><a href="#val-prepare_tail" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>prepare_tail : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-stmt">stmt</a> option</code></div><div class="doc"><p><code class="code">prepare_tail stmt</code> compile the remaining part of the SQL-statement
<code class="code">stmt</code> to bytecode.</p><ul class="at-tag"><li><p><span class="at-tag return">Returns</span> <code class="code">None</code> if there was no remaining part,
or <code class="code">Some remaining_part</code> otherwise.</p><p>NOTE: this really uses the C-function <code class="code">sqlite3_prepare_v2</code>,
i.e. avoids the older, deprecated <code class="code">sqlite3_prepare</code>-function.</p></li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement could not be prepared.</li></ul></div></div><div class="spec val" id="val-recompile"><a href="#val-recompile" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>recompile : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">recompile stmt</code> recompiles the SQL-statement associated with <code class="code">stmt</code>
to bytecode. The statement may be only partially compiled. In this
case <a href="index.html#val-prepare_tail">prepare_tail</a> can be called on the statement to compile the
remaining part of the SQL-statement. Call this function if the
statement expires due to some schema change.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement could not be recompiled.</li></ul></div></div><div class="spec val" id="val-step"><a href="#val-step" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>step : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">step stmt</code> performs one step of the query associated with
SQL-statement <code class="code">stmt</code>.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of this operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the step could not be executed.</li></ul></div></div><div class="spec val" id="val-finalize"><a href="#val-finalize" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>finalize : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">finalize stmt</code> finalizes the statement <code class="code">stmt</code>. After finalization,
the only valid usage of the statement is to use it in <a href="index.html#val-prepare_tail">prepare_tail</a>,
or to <a href="index.html#val-recompile">recompile</a> it.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of this operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement could not be finalized.</li></ul></div></div><div class="spec val" id="val-reset"><a href="#val-reset" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>reset : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">reset stmt</code> resets the statement <code class="code">stmt</code>, e.g. to restart the query,
perhaps with different bindings.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of this operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement could not be reset.</li></ul></div></div><div class="spec val" id="val-sleep"><a href="#val-sleep" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>sleep : int <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">sleep ms</code> sleeps at least <code class="code">ms</code> milliseconds.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the number of
milliseconds of sleep actually requested from the operating system.</li></ul></div></div><h3>Data query</h3><div class="spec val" id="val-data_count"><a href="#val-data_count" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>data_count : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">data_count stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the number of columns in the result of
the last step of statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-column_count"><a href="#val-column_count" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>column_count : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">column_count stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the number of columns that would be
returned by executing statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-column_blob"><a href="#val-column_blob" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>column_blob : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> string option</code></div><div class="doc"><p><code class="code">column_blob stmt n</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> <code class="code">Some bytes</code> in column <code class="code">n</code> of the
result of the last step of statement <code class="code">stmt</code>, or <code class="code">None</code> if NULL.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">RangeError</span>: if <code class="code">n</code> is out of range.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-column"><a href="#val-column" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>column : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a></code></div><div class="doc"><p><code class="code">column stmt n</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the data in column <code class="code">n</code> of the
result of the last step of statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">RangeError</span>: if <code class="code">n</code> is out of range.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-column_name"><a href="#val-column_name" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>column_name : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-header">header</a></code></div><div class="doc"><p><code class="code">column_name stmt n</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the header of column <code class="code">n</code> in the
result set of statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">RangeError</span>: if <code class="code">n</code> is out of range.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-column_decltype"><a href="#val-column_decltype" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>column_decltype : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> string option</code></div><div class="doc"><p><code class="code">column_decltype stmt n</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the declared type of the specified
column in the result set of statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">RangeError</span>: if <code class="code">n</code> is out of range.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><h3>Binding data to the query</h3><div class="spec val" id="val-bind"><a href="#val-bind" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>bind : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">bind stmt n data</code> binds the value <code class="code">data</code> to the free variable at
position <code class="code">n</code> of statement <code class="code">stmt</code>. NOTE: the first variable has
index <code class="code">1</code>!</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of this operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">RangeError</span>: if <code class="code">n</code> is out of range.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-bind_parameter_count"><a href="#val-bind_parameter_count" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>bind_parameter_count : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">bind_parameter_count stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the number of free variables in
statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-bind_parameter_name"><a href="#val-bind_parameter_name" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>bind_parameter_name : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> string option</code></div><div class="doc"><p><code class="code">bind_parameter_name stmt n</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> <code class="code">Some parameter_name</code> of the free
variable at position <code class="code">n</code> of statement <code class="code">stmt</code>, or <code class="code">None</code> if it is
ordinary (&quot;?&quot;).</li><li><span class="at-tag raise">Raises</span> <span class="module-path">RangeError</span>: if <code class="code">n</code> is out of range.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-bind_parameter_index"><a href="#val-bind_parameter_index" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>bind_parameter_index : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">bind_parameter_index stmt name</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the position of the free
variable with name <code class="code">name</code> in statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">Not_found</span>: if <code class="code">name</code> was not found.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-clear_bindings"><a href="#val-clear_bindings" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>clear_bindings : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></div><div class="doc"><p><code class="code">clear_bindings stmt</code> resets all bindings associated with prepared
statement <code class="code">stmt</code>.</p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the return code of this operation.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><h3>Stepwise query convenience functions</h3><div class="spec val" id="val-row_blobs"><a href="#val-row_blobs" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>row_blobs : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-row">row</a></code></div><div class="doc"><p><code class="code">row_blobs stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> the row returned by the last query step performed
with statement <code class="code">stmt</code> (array of optional blobs).</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-row_data"><a href="#val-row_data" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>row_data : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> array</code></div><div class="doc"><p><code class="code">row_data stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> all data values in the row returned by the
last query step performed with statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-row_names"><a href="#val-row_names" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>row_names : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-headers">headers</a></code></div><div class="doc"><p><code class="code">row_names stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> all column headers of the row returned by the
last query step performed with statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><div class="spec val" id="val-row_decltypes"><a href="#val-row_decltypes" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>row_decltypes : <a href="index.html#type-stmt">stmt</a> <span class="keyword">&#8209;&gt;</span> string option array</code></div><div class="doc"><p><code class="code">row_decltypes stmt</code></p><ul class="at-tag"><li><span class="at-tag return">Returns</span> all column type declarations of the
row returned by the last query step performed with statement <code class="code">stmt</code>.</li><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if the statement is invalid.</li></ul></div></div><h3>User-defined functions</h3><div class="spec val" id="val-create_funN"><a href="#val-create_funN" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_funN : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> array <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">create_funN db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">N</code>.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-create_fun0"><a href="#val-create_fun0" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_fun0 : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (unit <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">create_funN db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">0</code>.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-create_fun1"><a href="#val-create_fun1" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_fun1 : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">create_fun1 db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">1</code>.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-create_fun2"><a href="#val-create_fun2" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_fun2 : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">create_fun2 db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">2</code>.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-create_fun3"><a href="#val-create_fun3" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create_fun3 : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span class="keyword">&#8209;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">create_fun3 db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">3</code>.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-delete_function"><a href="#val-delete_function" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>delete_function : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">delete_function db name</code> deletes function with name <code class="code">name</code> from
database handle <code class="code">db</code>.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec val" id="val-busy_timeout"><a href="#val-busy_timeout" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>busy_timeout : <a href="index.html#type-db">db</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">busy_timeout db ms</code> sets a busy handler that sleeps for a
specified amount of time when a table is locked. The handler will
sleep multiple times until at least <code class="code">ms</code> milliseconds of sleeping
have accumulated.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">SqliteError</span>: if an invalid database handle is passed.</li></ul></div></div><div class="spec module" id="module-Aggregate"><a href="#module-Aggregate" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Aggregate/index.html">Aggregate</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Backup"><a href="#module-Backup" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Backup/index.html">Backup</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div></body></html>